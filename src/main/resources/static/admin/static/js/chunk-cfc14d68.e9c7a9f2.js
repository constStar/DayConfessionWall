(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-cfc14d68"],{"20b4":function(e,t,a){},5860:function(e,t,a){"use strict";a("20b4")},"942d":function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var s=a("b775"),r={pageList:function(e,t,a,r){return Object(s["a"])({url:"/api/admin/user/pageList",method:"get",params:{pageIndex:e,pageSize:t,rankName:a,rankType:r}})},count:function(){return Object(s["a"])({url:"/api/admin/user/count",method:"get"})},searchList:function(e,t,a,r,i){return Object(s["a"])({url:"/api/admin/user/searchList",method:"get",params:{keyword:e,pageIndex:t,pageSize:a,rankName:r,rankType:i}})},searchCount:function(e){return Object(s["a"])({url:"/api/admin/user/searchCount",method:"get",params:{keyword:e}})},user:function(e){return Object(s["a"])({url:"/api/admin/user/user",method:"get",params:{userId:e}})},getExamineCount:function(){return Object(s["a"])({url:"/api/admin/user/getExamineCount",method:"get"})},updateUser:function(e,t,a,r,i,o){return Object(s["a"])({url:"/api/admin/user/updateUser",method:"put",params:{userId:e,name:t,email:a,wechat:r,studentId:i,state:o}})},delete:function(e){return Object(s["a"])({url:"/api/admin/user/deleteUser",method:"delete",params:{userId:e}})}}},ddc3:function(e,t,a){"use strict";a.r(t);a("7f7f"),a("386d");var s=function(){var e=this,t=e._self._c;return t("div",[t("el-card",{attrs:{shadow:"hover"}},[t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.users,"row-class-name":e.tableRowClassName},on:{"sort-change":e.sortChange}},[t("el-table-column",{attrs:{sortable:"custom",prop:"id",width:"50"}}),t("el-table-column",{attrs:{sortable:"custom",prop:"name",label:"用户名称",width:"130"}}),t("el-table-column",{attrs:{sortable:"custom",prop:"studentId",label:"学号",width:"140"}}),t("el-table-column",{attrs:{sortable:"custom",prop:"email",label:"邮箱",width:"160"}}),t("el-table-column",{attrs:{sortable:"custom",prop:"wechat","show-overflow-tooltip":"",label:"微信",width:"90"}}),t("el-table-column",{attrs:{sortable:"custom",prop:"lastTime",label:"上次登录时间",width:"140"}}),t("el-table-column",{attrs:{sortable:"custom",prop:"createTime",label:"创建时间",width:"140"}}),t("el-table-column",{attrs:{sortable:"custom",prop:"roleName",label:"角色",width:"70"}}),t("el-table-column",{attrs:{sortable:"custom",prop:"stateName",label:"状态",width:"80"}}),t("el-table-column",{attrs:{width:"200"},scopedSlots:e._u([{key:"header",fn:function(a){return[t("el-input",{staticClass:"input-with-select",attrs:{size:"mini",placeholder:"请输入内容"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search.apply(null,arguments)}},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}},[e.isSearch?t("el-button",{attrs:{slot:"append",icon:"el-icon-close"},on:{click:e.clearSearch},slot:"append"}):e._e(),e.isSearch?e._e():t("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.search},slot:"append"})],1)]}},{key:"default",fn:function(a){return[t("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.openDialogEdit(a.$index)}}},[e._v("编辑")]),1==a.row.state?t("el-button",{attrs:{type:"success",size:"mini"},on:{click:function(t){return e.reportSuccess(a.$index,a.row.id)}}},[e._v("通过审核")]):e._e()]}}])})],1),t("el-pagination",{staticStyle:{"margin-top":"20px"},attrs:{background:"",layout:"prev, pager, next","current-page":e.pageIndex,"page-size":e.pageSize,total:e.userCount},on:{"update:currentPage":function(t){e.pageIndex=t},"update:current-page":function(t){e.pageIndex=t},"current-change":e.setPage}})],1),t("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],attrs:{visible:e.dialogEditShow,title:"编辑用户信息",top:"7vh",center:"",width:"40%",fullscreen:e.isMobile},on:{"update:visible":function(t){e.dialogEditShow=t}}},[t("el-form",{ref:"formRef",attrs:{model:e.form}},[t("div",[t("div",{staticStyle:{display:"inline-block",width:"75%"}},[t("el-form-item",{attrs:{label:"id"}},[t("el-input",{attrs:{disabled:""},model:{value:e.form.id,callback:function(t){e.$set(e.form,"id",t)},expression:"form.id"}})],1),t("el-form-item",{attrs:{label:"名称"}},[t("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1)],1),e.isMobile?e._e():t("div",{staticStyle:{display:"inline-block",width:"20%",margin:"10px"}},[t("img",{staticClass:"user-avatar",attrs:{src:e.IMAGE_URL+e.form.avatar,alt:""}})])]),t("el-form-item",{attrs:{label:"邮箱"}},[t("el-checkbox",{model:{value:e.form.emailIsNULL,callback:function(t){e.$set(e.form,"emailIsNULL",t)},expression:"form.emailIsNULL"}},[e._v("是否为空")]),t("el-input",{attrs:{disabled:e.form.emailIsNULL},model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}})],1),t("el-form-item",{attrs:{label:"微信"}},[t("el-checkbox",{model:{value:e.form.wechatIsNULL,callback:function(t){e.$set(e.form,"wechatIsNULL",t)},expression:"form.wechatIsNULL"}},[e._v("是否为空")]),t("el-input",{attrs:{disabled:e.form.wechatIsNULL},model:{value:e.form.wechat,callback:function(t){e.$set(e.form,"wechat",t)},expression:"form.wechat"}})],1),t("el-form-item",{attrs:{label:"学号"}},[t("el-checkbox",{model:{value:e.form.studentIdIsNULL,callback:function(t){e.$set(e.form,"studentIdIsNULL",t)},expression:"form.studentIdIsNULL"}},[e._v("是否为空")]),t("el-input",{attrs:{disabled:e.form.studentIdIsNULL},model:{value:e.form.studentId,callback:function(t){e.$set(e.form,"studentId",t)},expression:"form.studentId"}})],1),t("el-form-item",{attrs:{label:"状态"}},[t("el-select",{attrs:{placeholder:"用户状态"},model:{value:e.form.state,callback:function(t){e.$set(e.form,"state",t)},expression:"form.state"}},[t("el-option",{attrs:{label:"正常",value:0}}),t("el-option",{attrs:{label:"待审核",value:1}}),t("el-option",{attrs:{label:"封禁",value:-1}})],1)],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.closeDialogEdit}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.saveDialogEdit}},[e._v("保 存")])],1)],1)],1)},r=[],i=(a("456d"),a("ac6a"),a("942d")),o=a("403a"),n={name:"User",data:function(){return{IMAGE_URL:o["a"].image,users:[],sortName:null,sortType:null,pageIndex:1,pageSize:10,userCount:0,keyword:"",isSearch:!1,dialogEditShow:!1,form:{}}},created:function(){this.getUsers()},methods:{tableRowClassName:function(e){var t=e.row;e.rowIndex;return-1===t.state?"lock-row":1===t.state?"wait-row":""},sortChange:function(e){e.column;var t=e.order,a=e.prop;if(null==t)return this.sortName=null,void(this.sortType=null);"descending"==t?this.sortType=!1:"ascending"==t&&(this.sortType=!0),this.sortName="studentId"==a?"student_id":"lastTime"==a?"last_time":"createTime"==a?"create_time":"roleName"==a?"role_id":"stateName"==a?"state":a,this.getUsers()},reportSuccess:function(e,t){var a=this,s=this.users[e];s.id!=t&&this.$message.error("非法操作"),i["a"].updateUser(s.id,s.name,s.email,s.wechat,s.studentId,0).finally((function(){a.getUser(e)}))},openDialogEdit:function(e){var t=this,a=this.users[e];Object.keys(a).forEach((function(e){t.$set(t.form,e,a[e])})),this.$set(this.form,"index",e),this.$set(this.form,"emailIsNULL",null==a.email),this.$set(this.form,"wechatIsNULL",null==a.wechat),this.$set(this.form,"studentIdIsNULL",null==a.studentId),this.dialogEditShow=!0},saveDialogEdit:function(){var e=this;this.form.emailIsNULL&&(this.form.email=null),this.form.wechatIsNULL&&(this.form.wechat=null),this.form.studentIdIsNULL&&(this.form.studentId=null),i["a"].updateUser(this.form.id,this.form.name,this.form.email,this.form.wechat,this.form.studentId,this.form.state).then((function(t){e.getUser(e.form.index),e.closeDialogEdit(),e.$message.success(t.message)}))},closeDialogEdit:function(){this.dialogEditShow=!1},handleEdit:function(e){this.openDialog()},clearSearch:function(){this.pageIndex=1,this.keyword="",this.isSearch=!1,this.getUsers()},search:function(){this.pageIndex=1,""==this.keyword?this.isSearch=!1:this.isSearch=!0,this.getUsers()},setPage:function(e){this.getUsers()},getUser:function(e){var t=this;i["a"].user(this.users[e].id).then((function(a){t.$set(t.users,e,a.data)}))},getUsers:function(){var e=this;this.isSearch?(i["a"].searchCount(this.keyword).then((function(t){e.userCount=t.data})),i["a"].searchList(this.keyword,this.pageIndex,this.pageSize,this.sortName,this.sortType).then((function(t){e.users=t.data}))):(i["a"].count().then((function(t){e.userCount=t.data})),i["a"].pageList(this.pageIndex,this.pageSize,this.sortName,this.sortType).then((function(t){e.users=t.data})))}},computed:{isMobile:function(){return screen.width<=425}}},l=n,u=(a("5860"),a("2877")),c=Object(u["a"])(l,s,r,!1,null,null,null);t["default"]=c.exports}}]);