(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0af325"],{"0cfb":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e._self._c;return t("div",[t("el-tabs",{attrs:{type:"border-card"},on:{"tab-click":e.onTabClick}},[t("el-tab-pane",{attrs:{label:"基本设置"}},[t("div",{staticClass:"container"},[t("div",{staticClass:"form-box"},[t("el-form",{ref:"formBasicRef",attrs:{model:e.formBasic,"label-width":"170px"}},[t("el-form-item",{attrs:{label:"用户每天上传的图片数量"}},[t("el-input",{model:{value:e.formBasic["user-imageMaxNumberDay"],callback:function(t){e.$set(e.formBasic,"user-imageMaxNumberDay",t)},expression:"formBasic['user-imageMaxNumberDay']"}})],1),t("el-form-item",{attrs:{label:"帖子的图片数量"}},[t("el-input",{model:{value:e.formBasic["table-imageMaxNumber"],callback:function(t){e.$set(e.formBasic,"table-imageMaxNumber",t)},expression:"formBasic['table-imageMaxNumber']"}})],1),t("el-form-item",{attrs:{label:"评论的图片数量"}},[t("el-input",{model:{value:e.formBasic["comment-imageMaxNumber"],callback:function(t){e.$set(e.formBasic,"comment-imageMaxNumber",t)},expression:"formBasic['comment-imageMaxNumber']"}})],1),t("el-form-item",{attrs:{label:"邮箱通知周期（秒）"}},[t("el-input",{model:{value:e.formBasic["user-notifyEmailPeriod"],callback:function(t){e.$set(e.formBasic,"user-notifyEmailPeriod",t)},expression:"formBasic['user-notifyEmailPeriod']"}})],1),t("el-form-item",{attrs:{label:"跨域地址"}},[t("el-input",{model:{value:e.formBasic["cors-origin"],callback:function(t){e.$set(e.formBasic,"cors-origin",t)},expression:"formBasic['cors-origin']"}})],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:e.onSubmitBasic}},[e._v("保存")]),t("el-button",{on:{click:e.onReInput}},[e._v("重填")])],1)],1)],1)])]),t("el-tab-pane",{attrs:{label:"页面显示"}},[t("div",{staticClass:"container"},[t("div",{staticClass:"form-box"},[t("el-form",{ref:"formViewRef",attrs:{model:e.formView,"label-width":"80px"}},[t("el-form-item",{attrs:{label:"页面头部"}},[t("el-input",{attrs:{type:"textarea",rows:4},model:{value:e.formView["view-header"],callback:function(t){e.$set(e.formView,"view-header",t)},expression:"formView['view-header']"}})],1),t("el-form-item",{attrs:{label:"页面尾部"}},[t("el-input",{attrs:{type:"textarea",rows:4},model:{value:e.formView["view-footer"],callback:function(t){e.$set(e.formView,"view-footer",t)},expression:"formView['view-footer']"}})],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:e.onSubmitView}},[e._v("保存")]),t("el-button",{on:{click:e.onReInput}},[e._v("重填")])],1)],1)],1)])]),t("el-tab-pane",{attrs:{label:"STMP设置"}},[t("div",{staticClass:"container"},[t("div",{staticClass:"form-box"},[t("el-form",{ref:"formSMTPRef",attrs:{model:e.formSMTP,"label-width":"80px"}},[t("el-form-item",{attrs:{label:"SMTP服务器"}},[t("el-input",{model:{value:e.formSMTP["smtp-host"],callback:function(t){e.$set(e.formSMTP,"smtp-host",t)},expression:"formSMTP['smtp-host']"}})],1),t("el-form-item",{attrs:{label:"SMTP端口"}},[t("el-input",{model:{value:e.formSMTP["smtp-port"],callback:function(t){e.$set(e.formSMTP,"smtp-port",t)},expression:"formSMTP['smtp-port']"}})],1),t("el-form-item",{attrs:{label:"SSL"}},[t("el-checkbox",{model:{value:e.formSMTP["smtp-ssl"],callback:function(t){e.$set(e.formSMTP,"smtp-ssl",t)},expression:"formSMTP['smtp-ssl']"}})],1),t("el-form-item",{attrs:{label:"STMP用户"}},[t("el-input",{model:{value:e.formSMTP["smtp-username"],callback:function(t){e.$set(e.formSMTP,"smtp-username",t)},expression:"formSMTP['smtp-username']"}})],1),t("el-form-item",{attrs:{label:"STMP密码"}},[t("el-input",{model:{value:e.formSMTP["smtp-password"],callback:function(t){e.$set(e.formSMTP,"smtp-password",t)},expression:"formSMTP['smtp-password']"}})],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:e.onSubmitSTMP}},[e._v("保存")]),t("el-button",{on:{click:e.onReInput}},[e._v("重填")])],1)],1)],1)])]),t("el-tab-pane",{attrs:{label:"发送测试邮件"}},[t("div",{staticClass:"container"},[t("div",{staticClass:"form-box"},[t("el-form",{ref:"formTestEmailRef",attrs:{model:e.formTestEmail,"label-width":"80px"}},[t("el-form-item",{attrs:{label:"接收邮箱"}},[t("el-input",{model:{value:e.formTestEmail.receiveMail,callback:function(t){e.$set(e.formTestEmail,"receiveMail",t)},expression:"formTestEmail.receiveMail"}})],1),t("el-form-item",{attrs:{label:"主题"}},[t("el-input",{model:{value:e.formTestEmail.subject,callback:function(t){e.$set(e.formTestEmail,"subject",t)},expression:"formTestEmail.subject"}})],1),t("el-form-item",{attrs:{label:"内容"}},[t("el-input",{attrs:{type:"textarea",rows:5},model:{value:e.formTestEmail.content,callback:function(t){e.$set(e.formTestEmail,"content",t)},expression:"formTestEmail.content"}})],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:e.sendTestEmail}},[e._v("发送")])],1)],1)],1)])]),t("el-tab-pane",{attrs:{label:"关闭网站"}},[t("div",{staticClass:"container"},[t("div",{staticClass:"form-box"},[t("el-form",{ref:"formCloseRef",attrs:{model:e.formClose,"label-width":"120px"}},[t("el-form-item",{attrs:{label:"关闭网站"}},[t("el-checkbox",{model:{value:e.formClose["view-stop"],callback:function(t){e.$set(e.formClose,"view-stop",t)},expression:"formClose['view-stop']"}})],1),t("el-form-item",{attrs:{label:"网站关闭的原因"}},[t("el-input",{attrs:{type:"textarea",rows:4},model:{value:e.formClose["view-stopReason"],callback:function(t){e.$set(e.formClose,"view-stopReason",t)},expression:"formClose['view-stopReason']"}})],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:e.onSubmitClose}},[e._v("保存")]),t("el-button",{on:{click:e.onReInput}},[e._v("重填")])],1)],1)],1)])]),t("el-tab-pane",{attrs:{label:"执行SQL"}},[t("div",{staticClass:"container"},[t("el-form",{ref:"formSQLRef",attrs:{"label-width":"50px"},model:{value:e.formSQL,callback:function(t){e.formSQL=t},expression:"formSQL"}},[t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{xl:12,lg:12,md:24,sm:24,xs:24}},[t("el-form-item",{attrs:{label:"方式"}},[t("el-radio-group",{model:{value:e.formSQL.type,callback:function(t){e.$set(e.formSQL,"type",t)},expression:"formSQL.type"}},[t("el-radio",{attrs:{label:"Execute"}}),t("el-radio",{attrs:{label:"Update"}}),t("el-radio",{attrs:{label:"Query"}})],1)],1),t("el-form-item",{attrs:{label:"SQL"}},[t("el-input",{attrs:{type:"textarea",rows:5},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:t.ctrlKey?e.runSQL.apply(null,arguments):null}},model:{value:e.formSQL.sql,callback:function(t){e.$set(e.formSQL,"sql",t)},expression:"formSQL.sql"}})],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:e.runSQL}},[e._v("执行 (Ctrl+Enter)")])],1)],1),t("el-col",{attrs:{xl:12,lg:12,md:24,sm:24,xs:24}},[t("el-form-item",{attrs:{label:"消息"}},[t("el-input",{attrs:{readonly:"",type:"textarea",rows:6},model:{value:e.formSQL.message,callback:function(t){e.$set(e.formSQL,"message",t)},expression:"formSQL.message"}})],1),t("el-form-item",{attrs:{label:"数据"}},[t("el-input",{attrs:{readonly:"",type:"textarea",rows:15},model:{value:e.formSQL.data,callback:function(t){e.$set(e.formSQL,"data",t)},expression:"formSQL.data"}})],1)],1)],1)],1)],1)])],1)],1)},o=[],i=a("b775"),r={sqlForExecute:function(e){return Object(i["a"])({url:"/api/admin/setting/sqlForExecute",method:"post",params:{sql:e}})},sqlForUpdate:function(e){return Object(i["a"])({url:"/api/admin/setting/sqlForUpdate",method:"post",params:{sql:e}})},sqlForQuery:function(e){return Object(i["a"])({url:"/api/admin/setting/sqlForQuery",method:"post",params:{sql:e}})},getSettings:function(){return Object(i["a"])({url:"/api/admin/setting/getSettings",method:"get"})},updateSettings:function(e){return Object(i["a"])({url:"/api/admin/setting/updateSettings",method:"put",params:e})},emailTest:function(e,t,a){return Object(i["a"])({url:"/api/admin/setting/emailTest",method:"get",params:{receiveMail:e,subject:t,content:a}})}},l={name:"Setting",data:function(){return{data:{},formBasic:{"user-imageMaxNumberDay":27,"table-imageMaxNumber":9,"comment-imageMaxNumber":3,"user-notifyEmailPeriod":7200,"cors-origin":""},formView:{"view-header":"","view-footer":""},formSMTP:{"smtp-host":"","smtp-port":"","smtp-username":"","smtp-password":"","smtp-ssl":!1},formClose:{"view-stop":!1,"view-stopReason":""},formTestEmail:{receiveMail:"",subject:"",content:""},formSQL:{type:"Execute",sql:"",message:"",data:""}}},created:function(){this.init()},methods:{onTabClick:function(e){this.initData()},onReInput:function(){this.initData()},onSubmitBasic:function(){var e=this;r.updateSettings(this.formBasic).then((function(t){e.$message.success(t.message),e.init()}))},onSubmitView:function(){var e=this;r.updateSettings(this.formView).then((function(t){e.$message.success(t.message),e.init()}))},onSubmitSTMP:function(){var e=this;r.updateSettings(this.formSMTP).then((function(t){e.$message.success(t.message),e.init()}))},onSubmitClose:function(){var e=this;r.updateSettings(this.formClose).then((function(t){e.$message.success(t.message),e.init()}))},runSQL:function(){var e=this;if(""!=this.formSQL.sql){var t=function(e){return request()};"Execute"==this.formSQL.type?t=r.sqlForExecute:"Update"==this.formSQL.type?t=r.sqlForUpdate:"Query"==this.formSQL.type&&(t=r.sqlForQuery),t(this.formSQL.sql).then((function(t){e.formSQL.data=JSON.stringify(t.data,null,"\t"),e.formSQL.message=e.formSQL.sql+"\n"+e.formSQL.type+"-"+t.message})).catch((function(t){e.formSQL.message="发生错误：\n"+t}))}else this.$message.error("SQL不能为空")},sendTestEmail:function(){var e=this;r.emailTest(this.formTestEmail.receiveMail,this.formTestEmail.subject,this.formTestEmail.content).then((function(t){e.$message.success(t.message)}))},initData:function(){this.formBasic["comment-imageMaxNumber"]=this.data["comment-imageMaxNumber"],this.formBasic["table-imageMaxNumber"]=this.data["table-imageMaxNumber"],this.formBasic["user-imageMaxNumberDay"]=this.data["user-imageMaxNumberDay"],this.formBasic["user-notifyEmailPeriod"]=this.data["user-notifyEmailPeriod"],this.formBasic["cors-origin"]=this.data["cors-origin"],this.formView["view-header"]=this.data["view-header"],this.formView["view-footer"]=this.data["view-footer"],this.formSMTP["smtp-host"]=this.data["smtp-host"],this.formSMTP["smtp-port"]=this.data["smtp-port"],this.formSMTP["smtp-ssl"]="true"==this.data["smtp-ssl"],this.formSMTP["smtp-username"]=this.data["smtp-username"],this.formSMTP["smtp-password"]=this.data["smtp-password"],this.formClose["view-stop"]="true"==this.data["view-stop"],this.formClose["view-stopReason"]=this.data["view-stopReason"]},init:function(){var e=this;r.getSettings().then((function(t){e.data=t.data,e.initData()}))}}},m=l,n=a("2877"),f=Object(n["a"])(m,s,o,!1,null,null,null);t["default"]=f.exports}}]);